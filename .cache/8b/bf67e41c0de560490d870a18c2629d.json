{"id":"src/gif.js/gif.js","dependencies":[{"name":"/home/adgk/projects/canvaswriter/src/gif.js/gif.js.map","includedInParent":true,"mtime":1625500339339},{"name":"/home/adgk/projects/canvaswriter/package.json","includedInParent":true,"mtime":1625397246051}],"generated":{"js":"var define;\nvar global = arguments[3];\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n// gif.js 0.2.0 - https://github.com/jnordberg/gif.js\n(function (f) {\n  if ((typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) === 'object' && typeof module !== 'undefined') {\n    module.exports = f();\n  } else if (typeof define === 'function' && define.amd) {\n    define([], f);\n  } else {\n    var g;\n\n    if (typeof window !== 'undefined') {\n      g = window;\n    } else if (typeof global !== 'undefined') {\n      g = global;\n    } else if (typeof self !== 'undefined') {\n      g = self;\n    } else {\n      g = this;\n    }\n\n    g.GIF = f();\n  }\n})(function () {\n  var define, module, exports;\n  return function e(t, n, r) {\n    function s(o, u) {\n      if (!n[o]) {\n        if (!t[o]) {\n          var a = typeof require == 'function' && require;\n          if (!u && a) return a(o, !0);\n          if (i) return i(o, !0);\n          var f = new Error(\"Cannot find module '\" + o + \"'\");\n          throw f.code = 'MODULE_NOT_FOUND', f;\n        }\n\n        var l = n[o] = {\n          exports: {}\n        };\n        t[o][0].call(l.exports, function (e) {\n          var n = t[o][1][e];\n          return s(n ? n : e);\n        }, l, l.exports, e, t, n, r);\n      }\n\n      return n[o].exports;\n    }\n\n    var i = typeof require == 'function' && require;\n\n    for (var o = 0; o < r.length; o++) {\n      s(r[o]);\n    }\n\n    return s;\n  }({\n    1: [function (require, module, exports) {\n      function EventEmitter() {\n        this._events = this._events || {};\n        this._maxListeners = this._maxListeners || undefined;\n      }\n\n      module.exports = EventEmitter;\n      EventEmitter.EventEmitter = EventEmitter;\n      EventEmitter.prototype._events = undefined;\n      EventEmitter.prototype._maxListeners = undefined;\n      EventEmitter.defaultMaxListeners = 10;\n\n      EventEmitter.prototype.setMaxListeners = function (n) {\n        if (!isNumber(n) || n < 0 || isNaN(n)) throw TypeError('n must be a positive number');\n        this._maxListeners = n;\n        return this;\n      };\n\n      EventEmitter.prototype.emit = function (type) {\n        var er, handler, len, args, i, listeners;\n        if (!this._events) this._events = {};\n\n        if (type === 'error') {\n          if (!this._events.error || isObject(this._events.error) && !this._events.error.length) {\n            er = arguments[1];\n\n            if (er instanceof Error) {\n              throw er;\n            } else {\n              var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n              err.context = er;\n              throw err;\n            }\n          }\n        }\n\n        handler = this._events[type];\n        if (isUndefined(handler)) return false;\n\n        if (isFunction(handler)) {\n          switch (arguments.length) {\n            case 1:\n              handler.call(this);\n              break;\n\n            case 2:\n              handler.call(this, arguments[1]);\n              break;\n\n            case 3:\n              handler.call(this, arguments[1], arguments[2]);\n              break;\n\n            default:\n              args = Array.prototype.slice.call(arguments, 1);\n              handler.apply(this, args);\n          }\n        } else if (isObject(handler)) {\n          args = Array.prototype.slice.call(arguments, 1);\n          listeners = handler.slice();\n          len = listeners.length;\n\n          for (i = 0; i < len; i++) {\n            listeners[i].apply(this, args);\n          }\n        }\n\n        return true;\n      };\n\n      EventEmitter.prototype.addListener = function (type, listener) {\n        var m;\n        if (!isFunction(listener)) throw TypeError('listener must be a function');\n        if (!this._events) this._events = {};\n        if (this._events.newListener) this.emit('newListener', type, isFunction(listener.listener) ? listener.listener : listener);\n        if (!this._events[type]) this._events[type] = listener;else if (isObject(this._events[type])) this._events[type].push(listener);else this._events[type] = [this._events[type], listener];\n\n        if (isObject(this._events[type]) && !this._events[type].warned) {\n          if (!isUndefined(this._maxListeners)) {\n            m = this._maxListeners;\n          } else {\n            m = EventEmitter.defaultMaxListeners;\n          }\n\n          if (m && m > 0 && this._events[type].length > m) {\n            this._events[type].warned = true;\n            console.error('(node) warning: possible EventEmitter memory ' + 'leak detected. %d listeners added. ' + 'Use emitter.setMaxListeners() to increase limit.', this._events[type].length);\n\n            if (typeof console.trace === 'function') {\n              console.trace();\n            }\n          }\n        }\n\n        return this;\n      };\n\n      EventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\n      EventEmitter.prototype.once = function (type, listener) {\n        if (!isFunction(listener)) throw TypeError('listener must be a function');\n        var fired = false;\n\n        function g() {\n          this.removeListener(type, g);\n\n          if (!fired) {\n            fired = true;\n            listener.apply(this, arguments);\n          }\n        }\n\n        g.listener = listener;\n        this.on(type, g);\n        return this;\n      };\n\n      EventEmitter.prototype.removeListener = function (type, listener) {\n        var list, position, length, i;\n        if (!isFunction(listener)) throw TypeError('listener must be a function');\n        if (!this._events || !this._events[type]) return this;\n        list = this._events[type];\n        length = list.length;\n        position = -1;\n\n        if (list === listener || isFunction(list.listener) && list.listener === listener) {\n          delete this._events[type];\n          if (this._events.removeListener) this.emit('removeListener', type, listener);\n        } else if (isObject(list)) {\n          for (i = length; i-- > 0;) {\n            if (list[i] === listener || list[i].listener && list[i].listener === listener) {\n              position = i;\n              break;\n            }\n          }\n\n          if (position < 0) return this;\n\n          if (list.length === 1) {\n            list.length = 0;\n            delete this._events[type];\n          } else {\n            list.splice(position, 1);\n          }\n\n          if (this._events.removeListener) this.emit('removeListener', type, listener);\n        }\n\n        return this;\n      };\n\n      EventEmitter.prototype.removeAllListeners = function (type) {\n        var key, listeners;\n        if (!this._events) return this;\n\n        if (!this._events.removeListener) {\n          if (arguments.length === 0) this._events = {};else if (this._events[type]) delete this._events[type];\n          return this;\n        }\n\n        if (arguments.length === 0) {\n          for (key in this._events) {\n            if (key === 'removeListener') continue;\n            this.removeAllListeners(key);\n          }\n\n          this.removeAllListeners('removeListener');\n          this._events = {};\n          return this;\n        }\n\n        listeners = this._events[type];\n\n        if (isFunction(listeners)) {\n          this.removeListener(type, listeners);\n        } else if (listeners) {\n          while (listeners.length) {\n            this.removeListener(type, listeners[listeners.length - 1]);\n          }\n        }\n\n        delete this._events[type];\n        return this;\n      };\n\n      EventEmitter.prototype.listeners = function (type) {\n        var ret;\n        if (!this._events || !this._events[type]) ret = [];else if (isFunction(this._events[type])) ret = [this._events[type]];else ret = this._events[type].slice();\n        return ret;\n      };\n\n      EventEmitter.prototype.listenerCount = function (type) {\n        if (this._events) {\n          var evlistener = this._events[type];\n          if (isFunction(evlistener)) return 1;else if (evlistener) return evlistener.length;\n        }\n\n        return 0;\n      };\n\n      EventEmitter.listenerCount = function (emitter, type) {\n        return emitter.listenerCount(type);\n      };\n\n      function isFunction(arg) {\n        return typeof arg === 'function';\n      }\n\n      function isNumber(arg) {\n        return typeof arg === 'number';\n      }\n\n      function isObject(arg) {\n        return _typeof(arg) === 'object' && arg !== null;\n      }\n\n      function isUndefined(arg) {\n        return arg === void 0;\n      }\n    }, {}],\n    2: [function (require, module, exports) {\n      var UA, browser, mode, platform, ua;\n      ua = navigator.userAgent.toLowerCase();\n      platform = navigator.platform.toLowerCase();\n      UA = ua.match(/(opera|ie|firefox|chrome|version)[\\s\\/:]([\\w\\d\\.]+)?.*?(safari|version[\\s\\/:]([\\w\\d\\.]+)|$)/) || [null, 'unknown', 0];\n      mode = UA[1] === 'ie' && document.documentMode;\n      browser = {\n        name: UA[1] === 'version' ? UA[3] : UA[1],\n        version: mode || parseFloat(UA[1] === 'opera' && UA[4] ? UA[4] : UA[2]),\n        platform: {\n          name: ua.match(/ip(?:ad|od|hone)/) ? 'ios' : (ua.match(/(?:webos|android)/) || platform.match(/mac|win|linux/) || ['other'])[0]\n        }\n      };\n      browser[browser.name] = true;\n      browser[browser.name + parseInt(browser.version, 10)] = true;\n      browser.platform[browser.platform.name] = true;\n      module.exports = browser;\n    }, {}],\n    3: [function (require, module, exports) {\n      var EventEmitter,\n          GIF,\n          browser,\n          extend = function extend(child, parent) {\n        for (var key in parent) {\n          if (hasProp.call(parent, key)) child[key] = parent[key];\n        }\n\n        function ctor() {\n          this.constructor = child;\n        }\n\n        ctor.prototype = parent.prototype;\n        child.prototype = new ctor();\n        child.__super__ = parent.prototype;\n        return child;\n      },\n          hasProp = {}.hasOwnProperty,\n          indexOf = [].indexOf || function (item) {\n        for (var i = 0, l = this.length; i < l; i++) {\n          if (i in this && this[i] === item) return i;\n        }\n\n        return -1;\n      },\n          slice = [].slice;\n\n      EventEmitter = require('events').EventEmitter;\n      browser = require('./browser.coffee');\n\n      GIF = function (superClass) {\n        var defaults, frameDefaults;\n        extend(GIF, superClass);\n        defaults = {\n          workerScript: 'gif.worker.js',\n          workers: 2,\n          repeat: 0,\n          background: '#fff',\n          quality: 10,\n          width: null,\n          height: null,\n          transparent: null,\n          debug: false,\n          dither: false\n        };\n        frameDefaults = {\n          delay: 500,\n          copy: false\n        };\n\n        function GIF(options) {\n          var base, key, value;\n          this.running = false;\n          this.options = {};\n          this.frames = [];\n          this.freeWorkers = [];\n          this.activeWorkers = [];\n          this.setOptions(options);\n\n          for (key in defaults) {\n            value = defaults[key];\n\n            if ((base = this.options)[key] == null) {\n              base[key] = value;\n            }\n          }\n        }\n\n        GIF.prototype.setOption = function (key, value) {\n          this.options[key] = value;\n\n          if (this._canvas != null && (key === 'width' || key === 'height')) {\n            return this._canvas[key] = value;\n          }\n        };\n\n        GIF.prototype.setOptions = function (options) {\n          var key, results, value;\n          results = [];\n\n          for (key in options) {\n            if (!hasProp.call(options, key)) continue;\n            value = options[key];\n            results.push(this.setOption(key, value));\n          }\n\n          return results;\n        };\n\n        GIF.prototype.addFrame = function (image, options) {\n          var frame, key;\n\n          if (options == null) {\n            options = {};\n          }\n\n          frame = {};\n          frame.transparent = this.options.transparent;\n\n          for (key in frameDefaults) {\n            frame[key] = options[key] || frameDefaults[key];\n          }\n\n          if (this.options.width == null) {\n            this.setOption('width', image.width);\n          }\n\n          if (this.options.height == null) {\n            this.setOption('height', image.height);\n          }\n\n          if (typeof ImageData !== 'undefined' && ImageData !== null && image instanceof ImageData) {\n            frame.data = image.data;\n          } else if (typeof CanvasRenderingContext2D !== 'undefined' && CanvasRenderingContext2D !== null && image instanceof CanvasRenderingContext2D || typeof WebGLRenderingContext !== 'undefined' && WebGLRenderingContext !== null && image instanceof WebGLRenderingContext) {\n            if (options.copy) {\n              frame.data = this.getContextData(image);\n            } else {\n              frame.context = image;\n            }\n          } else if (image.childNodes != null) {\n            if (options.copy) {\n              frame.data = this.getImageData(image);\n            } else {\n              frame.image = image;\n            }\n          } else {\n            throw new Error('Invalid image');\n          }\n\n          return this.frames.push(frame);\n        };\n\n        GIF.prototype.render = function () {\n          var i, j, numWorkers, ref;\n\n          if (this.running) {\n            throw new Error('Already running');\n          }\n\n          if (this.options.width == null || this.options.height == null) {\n            throw new Error('Width and height must be set prior to rendering');\n          }\n\n          this.running = true;\n          this.nextFrame = 0;\n          this.finishedFrames = 0;\n\n          this.imageParts = function () {\n            var j, ref, results;\n            results = [];\n\n            for (i = j = 0, ref = this.frames.length; 0 <= ref ? j < ref : j > ref; i = 0 <= ref ? ++j : --j) {\n              results.push(null);\n            }\n\n            return results;\n          }.call(this);\n\n          numWorkers = this.spawnWorkers();\n\n          if (this.options.globalPalette === true) {\n            this.renderNextFrame();\n          } else {\n            for (i = j = 0, ref = numWorkers; 0 <= ref ? j < ref : j > ref; i = 0 <= ref ? ++j : --j) {\n              this.renderNextFrame();\n            }\n          }\n\n          this.emit('start');\n          return this.emit('progress', 0);\n        };\n\n        GIF.prototype.abort = function () {\n          var worker;\n\n          while (true) {\n            worker = this.activeWorkers.shift();\n\n            if (worker == null) {\n              break;\n            }\n\n            this.log('killing active worker');\n            worker.terminate();\n          }\n\n          this.running = false;\n          return this.emit('abort');\n        };\n\n        GIF.prototype.spawnWorkers = function () {\n          var j, numWorkers, ref, results;\n          numWorkers = Math.min(this.options.workers, this.frames.length);\n          (function () {\n            results = [];\n\n            for (var j = ref = this.freeWorkers.length; ref <= numWorkers ? j < numWorkers : j > numWorkers; ref <= numWorkers ? j++ : j--) {\n              results.push(j);\n            }\n\n            return results;\n          }).apply(this).forEach(function (_this) {\n            return function (i) {\n              var worker;\n\n              _this.log('spawning worker ' + i);\n\n              worker = new Worker(_this.options.workerScript);\n\n              worker.onmessage = function (event) {\n                _this.activeWorkers.splice(_this.activeWorkers.indexOf(worker), 1);\n\n                _this.freeWorkers.push(worker);\n\n                return _this.frameFinished(event.data);\n              };\n\n              return _this.freeWorkers.push(worker);\n            };\n          }(this));\n          return numWorkers;\n        };\n\n        GIF.prototype.frameFinished = function (frame) {\n          var i, j, ref;\n          this.log('frame ' + frame.index + ' finished - ' + this.activeWorkers.length + ' active');\n          this.finishedFrames++;\n          this.emit('progress', this.finishedFrames / this.frames.length);\n          this.imageParts[frame.index] = frame;\n\n          if (this.options.globalPalette === true) {\n            this.options.globalPalette = frame.globalPalette;\n            this.log('global palette analyzed');\n\n            if (this.frames.length > 2) {\n              for (i = j = 1, ref = this.freeWorkers.length; 1 <= ref ? j < ref : j > ref; i = 1 <= ref ? ++j : --j) {\n                this.renderNextFrame();\n              }\n            }\n          }\n\n          if (indexOf.call(this.imageParts, null) >= 0) {\n            return this.renderNextFrame();\n          } else {\n            return this.finishRendering();\n          }\n        };\n\n        GIF.prototype.finishRendering = function () {\n          var data, frame, i, image, j, k, l, len, len1, len2, len3, offset, page, ref, ref1, ref2;\n          len = 0;\n          ref = this.imageParts;\n\n          for (j = 0, len1 = ref.length; j < len1; j++) {\n            frame = ref[j];\n            len += (frame.data.length - 1) * frame.pageSize + frame.cursor;\n          }\n\n          len += frame.pageSize - frame.cursor;\n          this.log('rendering finished - filesize ' + Math.round(len / 1e3) + 'kb');\n          data = new Uint8Array(len);\n          offset = 0;\n          ref1 = this.imageParts;\n\n          for (k = 0, len2 = ref1.length; k < len2; k++) {\n            frame = ref1[k];\n            ref2 = frame.data;\n\n            for (i = l = 0, len3 = ref2.length; l < len3; i = ++l) {\n              page = ref2[i];\n              data.set(page, offset);\n\n              if (i === frame.data.length - 1) {\n                offset += frame.cursor;\n              } else {\n                offset += frame.pageSize;\n              }\n            }\n          }\n\n          image = new Blob([data], {\n            type: 'image/gif'\n          });\n          return this.emit('finished', image, data);\n        };\n\n        GIF.prototype.renderNextFrame = function () {\n          var frame, task, worker;\n\n          if (this.freeWorkers.length === 0) {\n            throw new Error('No free workers');\n          }\n\n          if (this.nextFrame >= this.frames.length) {\n            return;\n          }\n\n          frame = this.frames[this.nextFrame++];\n          worker = this.freeWorkers.shift();\n          task = this.getTask(frame);\n          this.log('starting frame ' + (task.index + 1) + ' of ' + this.frames.length);\n          this.activeWorkers.push(worker);\n          return worker.postMessage(task);\n        };\n\n        GIF.prototype.getContextData = function (ctx) {\n          return ctx.getImageData(0, 0, this.options.width, this.options.height).data;\n        };\n\n        GIF.prototype.getImageData = function (image) {\n          var ctx;\n\n          if (this._canvas == null) {\n            this._canvas = document.createElement('canvas');\n            this._canvas.width = this.options.width;\n            this._canvas.height = this.options.height;\n          }\n\n          ctx = this._canvas.getContext('2d');\n          ctx.setFill = this.options.background;\n          ctx.fillRect(0, 0, this.options.width, this.options.height);\n          ctx.drawImage(image, 0, 0);\n          return this.getContextData(ctx);\n        };\n\n        GIF.prototype.getTask = function (frame) {\n          var index, task;\n          index = this.frames.indexOf(frame);\n          task = {\n            index: index,\n            last: index === this.frames.length - 1,\n            delay: frame.delay,\n            transparent: frame.transparent,\n            width: this.options.width,\n            height: this.options.height,\n            quality: this.options.quality,\n            dither: this.options.dither,\n            globalPalette: this.options.globalPalette,\n            repeat: this.options.repeat,\n            canTransfer: browser.name === 'chrome'\n          };\n\n          if (frame.data != null) {\n            task.data = frame.data;\n          } else if (frame.context != null) {\n            task.data = this.getContextData(frame.context);\n          } else if (frame.image != null) {\n            task.data = this.getImageData(frame.image);\n          } else {\n            throw new Error('Invalid frame');\n          }\n\n          return task;\n        };\n\n        GIF.prototype.log = function () {\n          var args;\n          args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n\n          if (!this.options.debug) {\n            return;\n          }\n\n          return console.log.apply(console, args);\n        };\n\n        return GIF;\n      }(EventEmitter);\n\n      module.exports = GIF;\n    }, {\n      './browser.coffee': 2,\n      events: 1\n    }]\n  }, {}, [3])(3);\n});"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/browser-pack/_prelude.js","name":null,"original":{"line":1,"column":0},"generated":{"line":6,"column":1}},{"source":"node_modules/browser-pack/_prelude.js","name":"f","original":{"line":1,"column":0},"generated":{"line":6,"column":11}},{"source":"node_modules/browser-pack/_prelude.js","name":null,"original":{"line":1,"column":0},"generated":{"line":6,"column":12}},{"source":"node_modules/browser-pack/_prelude.js","name":null,"original":{"line":1,"column":0},"generated":{"line":6,"column":14}}],"sources":{"node_modules/browser-pack/_prelude.js":"(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})"},"lineCount":null}},"error":null,"hash":"61903a5e1a38af39465ac2423e3bf4e6","cacheData":{"env":{}}}